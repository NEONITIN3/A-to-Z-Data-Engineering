CREATE OR REPLACE EXTERNAL TABLE

  `bt-tch-3g-sunset-dp-dev.consumer_rw.usage_agg_mth_ext_table` (MSISDN STRING,

    AGG_MTH INTEGER,

    IMSI STRING,

    SUBSCRIBER_STATUS STRING,

    BRAND STRING,

    BILLING_BASE STRING,

    BUSINESS_TYPE STRING,

    TAR_PROTOCOL STRING,

    BASE_TYPE STRING,

    ACTIVE_30D_PAYG INTEGER,

    ACTIVE_90D_PAYG INTEGER,

    NEW_ACTIVE90D_PAYG INTEGER,

    ACCOUNT_TYPE STRING,

    ACCOUNT_NUM STRING,

    PRODUCT_CODE STRING,

    PRODUCT_DESCRIPTION STRING,

    PRODUCT_GROUP STRING,

    ARPU NUMERIC,

    CONTRACT_START_DATE DATE,

    CONTRACT_END_DATE DATE,

    MO_CALLS_2G INTEGER,

    MO_CALLS_3G INTEGER,

    MO_CALLS_4G INTEGER,

    MO_CALLS_WI INTEGER,

    MO_CALLS_OTHER INTEGER,

    MT_CALLS_2G INTEGER,

    MT_CALLS_3G INTEGER,

    MT_CALLS_4G INTEGER,

    MT_CALLS_WI INTEGER,

    MT_CALLS_OTHER INTEGER,

    MO_MINS_2G FLOAT,

    MO_MINS_3G FLOAT,

    MO_MINS_4G FLOAT,

    MO_MINS_WI FLOAT,

    MO_MINS_OTHER FLOAT,

    MT_MINS_2G FLOAT,

    MT_MINS_3G FLOAT,

    MT_MINS_4G FLOAT,

    MT_MINS_WI FLOAT,

    MT_MINS_OTHER FLOAT,

    MO_SMS_2G INTEGER,

    MO_SMS_3G INTEGER,

    MO_SMS_4G INTEGER,

    MO_SMS_WI INTEGER,

    MO_SMS_OTHER INTEGER,

    MT_SMS_2G INTEGER,

    MT_SMS_3G INTEGER,

    MT_SMS_4G INTEGER,

    MT_SMS_WI INTEGER,

    MT_SMS_OTHER INTEGER,

    DL_MB_2G FLOAT,

    DL_MB_3G FLOAT,

    DL_MB_4G FLOAT,

    DL_MB_5G FLOAT,

    DL_MB_OTHER FLOAT,

    UL_MB_2G FLOAT,

    UL_MB_3G FLOAT,

    UL_MB_4G FLOAT,

    UL_MB_5G FLOAT,

    UL_MB_OTHER FLOAT ) OPTIONS ( format = 'CSV',

    skip_leading_rows = 1,

    field_delimiter = ',',

    uris = ['gs://bt-dev-cleansed-ccn-mob-nwk-edwh-dim-cell-data/usage_agg_mth.csv'] );

